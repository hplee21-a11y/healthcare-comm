<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë³´ê±´ì˜ë£Œì •ë³´ ì „ë¬¸ê°€ì˜ 3ëŒ€ í•µì‹¬ ì—­ëŸ‰</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Use marked.js for rendering markdown from Gemini -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            height: 300px;
            margin: 0 auto;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .fade-in { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .card-hover:hover { transform: translateY(-5px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); }
        .transition-all-300 { transition: all 0.3s ease-in-out; }
        
        /* Markdown Styles for AI Output */
        .markdown-body h1, .markdown-body h2, .markdown-body h3 { font-weight: bold; margin-bottom: 0.5em; margin-top: 1em; }
        .markdown-body p { margin-bottom: 0.8em; }
        .markdown-body ul { list-style-type: disc; padding-left: 1.5em; margin-bottom: 0.8em; }
        .markdown-body strong { color: #0d9488; }
        
        /* Loading Animation */
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #0d9488;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
            display: inline-block;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
    <!-- Chosen Palette: Warm Neutrals & Medical Accents (Slate, Teal, Rose, Indigo) + AI Purple -->
    <!-- Application Structure Plan: 
         1. Hero Section: Introduces "Standard of Trust".
         2. Interactive Dashboard (3 Pillars): Central navigation.
         3. Deep Dive Sections: Content + Chart.js visualizations.
         4. Role-Play Simulator (Classic): Static case comparison.
         5. NEW âœ¨ AI Role-Play Coach: 
            - Feature A: Generate random hospital scenarios using Gemini.
            - Feature B: User inputs response -> Gemini analyzes based on 3 core competencies.
         6. Self-Check & Conclusion.
    -->
    <!-- Visualization & Content Choices:
         - Charts: Line, Bar, Doughnut (Chart.js)
         - AI: Text generation & Analysis via Gemini API.
         - NO SVG/Mermaid used. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="bg-slate-50 text-slate-800 antialiased">

    <!-- Header / Hero -->
    <header class="bg-white border-b border-slate-200 sticky top-0 z-50">
        <div class="max-w-6xl mx-auto px-4 py-4 flex justify-between items-center">
            <h1 class="text-xl font-bold text-slate-700">ğŸ¥ ë³´ê±´ì˜ë£Œì •ë³´ ì „ë¬¸ê°€ ê³¼ì •</h1>
            <div class="text-sm text-slate-500">3ëŒ€ í•µì‹¬ ì—­ëŸ‰ ë§ˆìŠ¤í„° ê°€ì´ë“œ</div>
        </div>
    </header>

    <main class="max-w-6xl mx-auto px-4 py-8 space-y-12">

        <!-- Hero Section -->
        <section class="text-center space-y-6 py-10 fade-in">
            <div class="inline-block px-3 py-1 bg-slate-100 text-slate-600 rounded-full text-sm font-semibold mb-2">The Standard of Trust</div>
            <h2 class="text-4xl md:text-5xl font-extrabold text-slate-800 leading-tight">
                í™˜ìì˜ ì‹ ë¢°ë¥¼ ì–»ëŠ”<br><span class="text-teal-600">ë³‘ì› í–‰ì •ì˜ ê¸°ì¤€</span>
            </h2>
            <p class="max-w-2xl mx-auto text-lg text-slate-600">
                ìš°ë¦¬ëŠ” ë‹¨ìˆœí•œ í–‰ì •ê°€ê°€ ì•„ë‹Œ, <strong>í™˜ì ê²½í—˜(Patient Experience)</strong>ì˜ ê´€ë¦¬ìì…ë‹ˆë‹¤.<br>
                ì‹ ë¢°ë¥¼ ì§€íƒ±í•˜ëŠ” 3ê°€ì§€ í•µì‹¬ ê¸°ë‘¥ì„ í™•ì¸í•´ë³´ì„¸ìš”.
            </p>
        </section>

        <!-- Navigation / Pillars Dashboard -->
        <section id="pillars" class="grid grid-cols-1 md:grid-cols-3 gap-6 fade-in">
            <!-- Pillar 1: Professionalism -->
            <div onclick="selectPillar('professionalism')" class="cursor-pointer bg-white p-6 rounded-xl border border-slate-200 shadow-sm card-hover transition-all-300 group hover:border-teal-500">
                <div class="text-4xl mb-4 group-hover:scale-110 transition-transform">ğŸ“Š</div>
                <h3 class="text-xl font-bold text-slate-800 mb-2 group-hover:text-teal-600">Professionalism</h3>
                <h4 class="text-sm font-semibold text-slate-500 uppercase tracking-wide mb-3">ì „ë¬¸ì„±</h4>
                <p class="text-slate-600 text-sm">ì •í™•í•˜ê³  ì‹ ì†í•œ ì¼ ì²˜ë¦¬ë¡œ ì‹ ë¢°ì˜ ì‹œì‘ì„ ë§Œë“­ë‹ˆë‹¤. ì˜¤ì°¨ ì—†ëŠ” ì—…ë¬´ ìˆ˜í–‰ ëŠ¥ë ¥.</p>
                <div class="mt-4 text-teal-600 text-sm font-medium flex items-center">ìì„¸íˆ ë³´ê¸° &rarr;</div>
            </div>

            <!-- Pillar 2: Empathy -->
            <div onclick="selectPillar('empathy')" class="cursor-pointer bg-white p-6 rounded-xl border border-slate-200 shadow-sm card-hover transition-all-300 group hover:border-rose-500">
                <div class="text-4xl mb-4 group-hover:scale-110 transition-transform">ğŸ’“</div>
                <h3 class="text-xl font-bold text-slate-800 mb-2 group-hover:text-rose-600">Empathy</h3>
                <h4 class="text-sm font-semibold text-slate-500 uppercase tracking-wide mb-3">ê³µê°</h4>
                <p class="text-slate-600 text-sm">í™˜ìì˜ ë¶ˆì•ˆì„ ì´í•´í•˜ê³  ë°°ë ¤í•˜ëŠ” ë§ˆìŒ. ë§ˆìŒê¹Œì§€ ì¹˜ìœ í•˜ëŠ” í–‰ì •.</p>
                <div class="mt-4 text-rose-600 text-sm font-medium flex items-center">ìì„¸íˆ ë³´ê¸° &rarr;</div>
            </div>

            <!-- Pillar 3: Responsibility -->
            <div onclick="selectPillar('responsibility')" class="cursor-pointer bg-white p-6 rounded-xl border border-slate-200 shadow-sm card-hover transition-all-300 group hover:border-indigo-500">
                <div class="text-4xl mb-4 group-hover:scale-110 transition-transform">ğŸ¤</div>
                <h3 class="text-xl font-bold text-slate-800 mb-2 group-hover:text-indigo-600">Responsibility</h3>
                <h4 class="text-sm font-semibold text-slate-500 uppercase tracking-wide mb-3">ì±…ì„ê°</h4>
                <p class="text-slate-600 text-sm">ë¬¸ì œë¥¼ ëê¹Œì§€ í•´ê²°í•˜ëŠ” íƒœë„. í™˜ìì˜ ë“ ë“ í•œ íŒŒíŠ¸ë„ˆ.</p>
                <div class="mt-4 text-indigo-600 text-sm font-medium flex items-center">ìì„¸íˆ ë³´ê¸° &rarr;</div>
            </div>
        </section>

        <!-- Detailed Content Section (Dynamic) -->
        <section id="detail-section" class="bg-white rounded-2xl shadow-lg border border-slate-100 overflow-hidden hidden fade-in">
            <div class="grid grid-cols-1 lg:grid-cols-2">
                <!-- Content Side -->
                <div class="p-8 lg:p-12 flex flex-col justify-center">
                    <div class="mb-6">
                        <span id="detail-icon" class="text-5xl"></span>
                    </div>
                    <h3 id="detail-title" class="text-3xl font-bold text-slate-800 mb-2"></h3>
                    <p id="detail-slogan" class="text-lg text-slate-500 italic mb-6"></p>
                    
                    <div class="space-y-6">
                        <div class="bg-slate-50 p-4 rounded-lg border-l-4" id="detail-border-color">
                            <h4 class="font-bold text-slate-700 mb-1">í•µì‹¬ ì •ì˜</h4>
                            <p id="detail-definition" class="text-slate-600"></p>
                        </div>

                        <div>
                            <h4 class="font-bold text-slate-800 mb-3 border-b pb-2">Must Do: í–‰ë™ ì§€ì¹¨</h4>
                            <ul id="detail-list" class="space-y-3"></ul>
                        </div>

                        <div class="bg-slate-800 text-white p-4 rounded-lg mt-4">
                            <span class="font-bold text-yellow-400">ğŸ’¡ Key Message:</span>
                            <span id="detail-message"></span>
                        </div>
                    </div>
                </div>

                <!-- Visualization Side -->
                <div class="bg-slate-50 p-8 lg:p-12 flex flex-col items-center justify-center border-t lg:border-t-0 lg:border-l border-slate-100">
                    <h4 class="text-lg font-bold text-slate-700 mb-4 w-full text-center">ë°ì´í„°ë¡œ ë³´ëŠ” ì—­ëŸ‰ì˜ íš¨ê³¼</h4>
                    <p class="text-sm text-slate-500 mb-6 text-center px-4">ì•„ë˜ ì°¨íŠ¸ëŠ” í•´ë‹¹ ì—­ëŸ‰ì´ ë³‘ì› ìš´ì˜ê³¼ í™˜ì ê²½í—˜ì— ë¯¸ì¹˜ëŠ” ê¸ì •ì ì¸ ì˜í–¥ì„ ì‹œê°í™”í•œ ê°€ìƒ ë°ì´í„°ì…ë‹ˆë‹¤.</p>
                    <div class="chart-container">
                        <canvas id="competencyChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- Role Play / Case Study Section (Original) -->
        <section class="py-10 fade-in border-t border-slate-200">
            <div class="text-center mb-10">
                <div class="inline-block px-3 py-1 bg-teal-100 text-teal-800 rounded-full text-xs font-bold mb-2 tracking-wider">BASIC TRAINING</div>
                <h2 class="text-3xl font-bold text-slate-800 mb-4">ê¸°ì´ˆ ì‚¬ë¡€ ì—°êµ¬ (Basic Role-Play)</h2>
                <p class="text-slate-600 max-w-2xl mx-auto">
                    ëŒ€í‘œì ì¸ ë³‘ì› ìƒí™©ì—ì„œ 'ì•„ë§ˆì¶”ì–´'ì™€ 'í”„ë¡œ'ì˜ ì°¨ì´ë¥¼ ë¹„êµí•˜ë©° í•™ìŠµí•˜ì„¸ìš”.
                </p>
            </div>

            <div class="bg-white rounded-xl shadow-md border border-slate-200 overflow-hidden max-w-4xl mx-auto">
                <!-- Case Selector -->
                <div class="bg-slate-100 p-4 border-b border-slate-200 flex justify-center">
                    <div class="relative inline-block w-full max-w-xs">
                        <select id="case-selector" onchange="loadCase()" class="block appearance-none w-full bg-white border border-slate-300 hover:border-slate-400 px-4 py-2 pr-8 rounded shadow leading-tight focus:outline-none focus:shadow-outline">
                            <option value="0">ìƒí™© 1: ë³µì¡í•œ ë³´í—˜ ì„œë¥˜ ìš”ì²­</option>
                            <option value="1">ìƒí™© 2: ëŒ€ê¸° ì‹œê°„ì— í™”ë‚œ í™˜ì</option>
                            <option value="2">ìƒí™© 3: ìˆ˜ë‚© ê¸ˆì•¡ ì˜¤ë¥˜ ë°œìƒ</option>
                        </select>
                        <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-slate-700">
                            <svg class="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"/></svg>
                        </div>
                    </div>
                </div>

                <!-- Case Content -->
                <div class="p-6 md:p-10 grid grid-cols-1 md:grid-cols-2 gap-8">
                    <!-- Bad Case -->
                    <div class="bg-red-50 rounded-lg p-6 border border-red-100">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-red-800 font-bold flex items-center"><span class="text-xl mr-2">ğŸ˜•</span> ì•„ë§ˆì¶”ì–´</h3>
                        </div>
                        <div id="bad-case-content" class="bg-white p-4 rounded shadow-sm min-h-[100px] flex items-center text-slate-700 italic"></div>
                    </div>
                    <!-- Good Case -->
                    <div class="bg-teal-50 rounded-lg p-6 border border-teal-100 relative overflow-hidden">
                         <div class="flex items-center justify-between mb-4">
                            <h3 class="text-teal-800 font-bold flex items-center"><span class="text-xl mr-2">ğŸ¤©</span> í”„ë¡œ</h3>
                            <span id="case-badge" class="text-xs bg-teal-200 text-teal-800 px-2 py-1 rounded-full font-bold"></span>
                        </div>
                        <div id="good-case-content" class="bg-white p-4 rounded shadow-sm min-h-[100px] flex items-center text-slate-800 font-medium border-l-4 border-teal-500"></div>
                        <div class="mt-4 text-sm text-teal-700 bg-teal-100 p-2 rounded">
                            <strong>Why?</strong> <span id="case-reason"></span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- âœ¨ NEW: AI Features Section -->
        <section class="py-12 fade-in relative overflow-hidden rounded-3xl bg-gradient-to-br from-indigo-900 to-purple-900 text-white shadow-2xl">
            <!-- Decorative background elements -->
            <div class="absolute top-0 right-0 -mr-20 -mt-20 w-64 h-64 rounded-full bg-purple-500 opacity-20 blur-3xl"></div>
            <div class="absolute bottom-0 left-0 -ml-20 -mb-20 w-80 h-80 rounded-full bg-indigo-500 opacity-20 blur-3xl"></div>

            <div class="relative z-10 max-w-4xl mx-auto px-6">
                <div class="text-center mb-10">
                    <div class="inline-block px-3 py-1 bg-purple-500 bg-opacity-30 border border-purple-400 text-purple-100 rounded-full text-xs font-bold mb-3 tracking-wider">POWERED BY GEMINI</div>
                    <h2 class="text-3xl md:text-4xl font-bold mb-4">âœ¨ AI ë§ì¶¤í˜• ì‹¤ì „ ì½”ì¹­ (AI Coach)</h2>
                    <p class="text-purple-100 text-lg max-w-2xl mx-auto">
                        ì˜ˆì¸¡ ë¶ˆê°€ëŠ¥í•œ ë³‘ì› í˜„ì¥, AIì™€ í•¨ê»˜ ë¯¸ë¦¬ ê²½í—˜í•˜ì„¸ìš”.<br>
                        ì‹¤ì œ ìƒí™©ì„ ìƒì„±í•˜ê³  ë‹¹ì‹ ì˜ ë‹µë³€ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ í”¼ë“œë°± ë°›ìœ¼ì„¸ìš”.
                    </p>
                </div>

                <div class="grid grid-cols-1 gap-8">
                    <!-- Step 1: Generate Scenario -->
                    <div class="bg-white/10 backdrop-blur-md rounded-2xl p-6 md:p-8 border border-white/20">
                        <div class="flex flex-col md:flex-row justify-between items-center mb-6">
                            <h3 class="text-xl font-bold flex items-center mb-4 md:mb-0">
                                <span class="bg-purple-600 p-2 rounded-lg mr-3">1ï¸âƒ£</span>
                                ìƒí™© ìƒì„± (Scenario Generation)
                            </h3>
                            <button onclick="generateScenario()" id="btn-generate" class="group relative px-6 py-3 bg-white text-indigo-900 font-bold rounded-full hover:bg-purple-50 transition-all shadow-lg hover:shadow-xl active:scale-95 flex items-center">
                                <span id="spinner-gen" class="loader mr-2 hidden border-indigo-900 border-t-transparent"></span>
                                <span>âœ¨ ìƒˆë¡œìš´ ìƒí™© ìƒì„±í•˜ê¸°</span>
                            </button>
                        </div>
                        
                        <div id="ai-scenario-box" class="bg-black/20 rounded-xl p-6 min-h-[100px] flex items-center justify-center text-center text-purple-200 border border-white/10">
                            "ìœ„ ë²„íŠ¼ì„ ëˆŒëŸ¬ AIê°€ ë§Œë“œëŠ” ë‹¤ì–‘í•œ ë³‘ì› ìƒí™©ì„ ê²½í—˜í•´ë³´ì„¸ìš”."
                        </div>
                    </div>

                    <!-- Step 2: User Input & Analysis -->
                    <div class="bg-white/10 backdrop-blur-md rounded-2xl p-6 md:p-8 border border-white/20">
                        <h3 class="text-xl font-bold flex items-center mb-6">
                            <span class="bg-purple-600 p-2 rounded-lg mr-3">2ï¸âƒ£</span>
                            ë‚˜ì˜ ì‘ëŒ€ & AI í”¼ë“œë°±
                        </h3>
                        
                        <div class="mb-6">
                            <label class="block text-sm text-purple-200 mb-2 font-medium">ë‹¹ì‹ ì´ë¼ë©´ ì–´ë–»ê²Œ ì‘ëŒ€í•˜ì‹œê² ìŠµë‹ˆê¹Œ?</label>
                            <textarea id="user-response" rows="3" class="w-full bg-white/90 text-slate-800 rounded-xl p-4 focus:ring-4 focus:ring-purple-500 focus:outline-none placeholder-slate-400" placeholder="í™˜ìë‚˜ ë™ë£Œì—ê²Œ ê±´ë„¬ ë§ì„ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
                        </div>

                        <div class="flex justify-end mb-6">
                            <button onclick="analyzeResponse()" id="btn-analyze" class="px-6 py-3 bg-purple-600 hover:bg-purple-500 text-white font-bold rounded-full transition-all shadow-lg active:scale-95 flex items-center disabled:opacity-50 disabled:cursor-not-allowed">
                                <span id="spinner-analyze" class="loader mr-2 hidden border-white border-t-transparent"></span>
                                <span>âœ¨ AI ë¶„ì„ ë° í”¼ë“œë°± ë°›ê¸°</span>
                            </button>
                        </div>

                        <!-- Feedback Result -->
                        <div id="ai-feedback-box" class="hidden bg-white text-slate-800 rounded-xl p-6 border-l-8 border-purple-500 shadow-xl">
                            <h4 class="text-lg font-bold text-indigo-900 mb-4 flex items-center">
                                <span class="text-2xl mr-2">ğŸ¤–</span> AI ì½”ì¹˜ ë¶„ì„ ë¦¬í¬íŠ¸
                            </h4>
                            <div id="ai-feedback-content" class="markdown-body text-sm md:text-base leading-relaxed text-slate-700">
                                <!-- Feedback content goes here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Self Checklist -->
        <section class="bg-slate-800 text-white rounded-2xl p-8 md:p-12 text-center fade-in">
            <h2 class="text-2xl md:text-3xl font-bold mb-6">ì˜¤ëŠ˜ì˜ í•™ìŠµ ì ê²€</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 text-left max-w-4xl mx-auto mb-8">
                <!-- Checkboxes -->
                <label class="flex items-center space-x-3 cursor-pointer p-3 bg-slate-700 rounded hover:bg-slate-600 transition">
                    <input type="checkbox" class="form-checkbox h-5 w-5 text-teal-500 rounded focus:ring-teal-500 border-gray-300" onchange="updateProgress()">
                    <span>ì˜í•™ ìš©ì–´ ë° ì‹¬ì‚¬ ê¸°ì¤€ ìˆ™ì§€</span>
                </label>
                <label class="flex items-center space-x-3 cursor-pointer p-3 bg-slate-700 rounded hover:bg-slate-600 transition">
                    <input type="checkbox" class="form-checkbox h-5 w-5 text-teal-500 rounded focus:ring-teal-500 border-gray-300" onchange="updateProgress()">
                    <span>í™˜ìì™€ ëˆˆ ë§ì¶¤ (Eye Contact)</span>
                </label>
                <label class="flex items-center space-x-3 cursor-pointer p-3 bg-slate-700 rounded hover:bg-slate-600 transition">
                    <input type="checkbox" class="form-checkbox h-5 w-5 text-teal-500 rounded focus:ring-teal-500 border-gray-300" onchange="updateProgress()">
                    <span>ì‰¬ìš´ ìš©ì–´ë¡œ ì„¤ëª…í•˜ê¸°</span>
                </label>
                <label class="flex items-center space-x-3 cursor-pointer p-3 bg-slate-700 rounded hover:bg-slate-600 transition">
                    <input type="checkbox" class="form-checkbox h-5 w-5 text-teal-500 rounded focus:ring-teal-500 border-gray-300" onchange="updateProgress()">
                    <span>'0' ì˜¤ë¥˜(Zero Error) ì§€í–¥</span>
                </label>
                <label class="flex items-center space-x-3 cursor-pointer p-3 bg-slate-700 rounded hover:bg-slate-600 transition">
                    <input type="checkbox" class="form-checkbox h-5 w-5 text-teal-500 rounded focus:ring-teal-500 border-gray-300" onchange="updateProgress()">
                    <span>ë¬¸ì œ ë°œìƒ ì‹œ ëê¹Œì§€ í•´ê²° í™•ì¸</span>
                </label>
                <label class="flex items-center space-x-3 cursor-pointer p-3 bg-slate-700 rounded hover:bg-slate-600 transition">
                    <input type="checkbox" class="form-checkbox h-5 w-5 text-teal-500 rounded focus:ring-teal-500 border-gray-300" onchange="updateProgress()">
                    <span>ë¶ˆë§Œì„ ê°œì„ ì˜ ê¸°íšŒë¡œ ì‚¼ê¸°</span>
                </label>
            </div>
            
            <div class="w-full bg-slate-600 rounded-full h-4 mb-4 max-w-md mx-auto">
                <div id="progress-bar" class="bg-teal-400 h-4 rounded-full transition-all duration-500" style="width: 0%"></div>
            </div>
            <p id="progress-text" class="text-slate-300">ìœ„ í•­ëª©ë“¤ì„ ì²´í¬í•˜ì—¬ ë‹¹ì‹ ì˜ í”„ë¡œ ì§€ìˆ˜ë¥¼ í™•ì¸í•˜ì„¸ìš”.</p>
        </section>

        <!-- Footer -->
        <footer class="text-center pt-8 pb-12 border-t border-slate-200">
            <h3 class="text-xl font-bold text-slate-800 mb-2">ì—¬ëŸ¬ë¶„ì˜ íƒœë„ê°€ ê³§ ë³‘ì›ì˜ ì–¼êµ´ì…ë‹ˆë‹¤.</h3>
            <p class="text-slate-500">Professionalism, Empathy, Responsibilityê°€ ëª¨ì—¬ ëŒ€ì²´ ë¶ˆê°€ëŠ¥í•œ ì „ë¬¸ê°€ë¥¼ ë§Œë“­ë‹ˆë‹¤.</p>
        </footer>

    </main>

    <script>
        // API Key (Filled at runtime)
        const apiKey = ""; 

        // Data Store (Original Content)
        const competencies = {
            professionalism: {
                title: "Professionalism (ì „ë¬¸ì„±)",
                slogan: "ì‹ ë¢°ì˜ ì‹œì‘ì€ 'ì •í™•í•¨'ì—ì„œ ì˜¨ë‹¤",
                icon: "ğŸ“Š",
                definition: "ì˜ë£Œ ì§€ì‹ê³¼ í–‰ì • ê¸°ìˆ ì„ ë°”íƒ•ìœ¼ë¡œ ì˜¤ì°¨ ì—†ì´ ì—…ë¬´ë¥¼ ìˆ˜í–‰í•˜ëŠ” ëŠ¥ë ¥ì…ë‹ˆë‹¤.",
                list: [
                    "<strong>Zero Error:</strong> í™˜ì ì •ë³´, ì²­êµ¬ ì½”ë“œ, ìˆ˜ë‚© ê¸ˆì•¡ì˜ '0' ì˜¤ë¥˜ ì§€í–¥",
                    "<strong>Knowledge:</strong> ì˜í•™ ìš©ì–´ ë° ê±´ê°•ë³´í—˜ ì‹¬ì‚¬ ê¸°ì¤€ì˜ ì™„ë²½í•œ ìˆ™ì§€",
                    "<strong>Efficiency:</strong> í™˜ìì˜ ëŒ€ê¸° ì‹œê°„ì„ ì¤„ì´ëŠ” íš¨ìœ¨ì  í”„ë¡œì„¸ìŠ¤ ê´€ë¦¬"
                ],
                message: "ì¹œì ˆí•˜ê¸°ë§Œ í•˜ê³  ì¼ ì²˜ë¦¬ê°€ ì—‰ë§ì´ë©´ í”„ë¡œê°€ ì•„ë‹™ë‹ˆë‹¤. ì •í™•ì„±ì€ ê¸°ë³¸ì…ë‹ˆë‹¤.",
                colorClass: "border-teal-500",
                chartType: 'line',
                chartLabel: 'ì—…ë¬´ ìˆ™ë ¨ë„ì— ë”°ë¥¸ ì˜¤ë¥˜ ë°œìƒë¥ ',
                chartData: [20, 15, 8, 3, 1, 0.1],
                chartLabels: ['1ê°œì›”', '3ê°œì›”', '6ê°œì›”', '1ë…„', '3ë…„', '5ë…„'],
                chartColor: 'rgb(13, 148, 136)'
            },
            empathy: {
                title: "Empathy (ê³µê°)",
                slogan: "í™˜ìì˜ ë§ˆìŒê¹Œì§€ ì¹˜ìœ í•˜ëŠ” í–‰ì •",
                icon: "ğŸ’“",
                definition: "í™˜ìì˜ ì‹ ì²´ì  ê³ í†µë¿ë§Œ ì•„ë‹ˆë¼ ì‹¬ë¦¬ì  ë¶ˆì•ˆì„ ì¸ì§€í•˜ê³  ë°°ë ¤í•˜ëŠ” íƒœë„ì…ë‹ˆë‹¤.",
                list: [
                    "<strong>Active Listening:</strong> ëª¨ë‹ˆí„°ë§Œ ë³´ì§€ ì•Šê³  í™˜ìì˜ ëˆˆì„ ë§ì¶”ë©° ê²½ì²­",
                    "<strong>Cushion Language:</strong> 'ë§ì´ ë†€ë¼ì…¨ì£ ?', 'í˜ë“œì…¨ì£ ?'ì™€ ê°™ì€ ê³µê° ì–¸ì–´ ì‚¬ìš©",
                    "<strong>Easy Explanation:</strong> ì „ë¬¸ ìš©ì–´ê°€ ì•„ë‹Œ, í™˜ìì˜ ëˆˆë†’ì´ì— ë§ì¶˜ ì‰¬ìš´ ìš©ì–´ ì‚¬ìš©"
                ],
                message: "í™˜ìì˜ ë¶ˆì•ˆì„ ë¨¼ì € ì½ì–´ì£¼ëŠ” ê²ƒì´ ì§„ì§œ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.",
                colorClass: "border-rose-500",
                chartType: 'bar',
                chartLabel: 'ê³µê°ì  ì†Œí†µ ìœ ë¬´ì— ë”°ë¥¸ í™˜ì ì‹ ë¢°ë„ ì ìˆ˜ (10ì  ë§Œì )',
                chartData: [3.5, 9.2],
                chartLabels: ['ê¸°ê³„ì  ì‘ëŒ€', 'ê³µê°ì  ì‘ëŒ€'],
                chartColor: 'rgb(225, 29, 72)'
            },
            responsibility: {
                title: "Responsibility (ì±…ì„ê°)",
                slogan: "ëê¹Œì§€ í•¨ê»˜í•˜ëŠ” ë“ ë“ í•œ íŒŒíŠ¸ë„ˆ",
                icon: "ğŸ¤",
                definition: "ì—…ë¬´ ì¤‘ ë°œìƒí•œ ë¬¸ì œë¥¼ íšŒí”¼í•˜ì§€ ì•Šê³ , í•´ê²°ë  ë•Œê¹Œì§€ ì™„ìˆ˜í•˜ëŠ” ìì„¸ì…ë‹ˆë‹¤.",
                list: [
                    "<strong>Ownership:</strong> 'ì œ ë‹´ë‹¹ì´ ì•„ë‹™ë‹ˆë‹¤' (X) â†’ 'í™•ì¸ í›„ ì•ˆë‚´í•´ ë“œë¦¬ê² ìŠµë‹ˆë‹¤' (O)",
                    "<strong>Follow-up:</strong> íƒ€ ë¶€ì„œ ì¸ê³„ í›„ì—ë„ í™˜ìì˜ ë¬¸ì œê°€ í•´ê²°ë˜ì—ˆëŠ”ì§€ ìµœì¢… í™•ì¸",
                    "<strong>Problem Solving:</strong> í™˜ìì˜ ë¶ˆë§Œ(Complain)ì„ ê°œì„ ì˜ ê¸°íšŒë¡œ ì‚¼ëŠ” íƒœë„"
                ],
                message: "í™˜ìì˜ ë¬¸ì œëŠ” ë‚´ ì†ì—ì„œ ëë‚¸ë‹¤ëŠ” ì£¼ì¸ì˜ì‹ì´ í•„ìš”í•©ë‹ˆë‹¤.",
                colorClass: "border-indigo-500",
                chartType: 'doughnut',
                chartLabel: 'ë¯¼ì› í•´ê²° ë§Œì¡±ë„ êµ¬ì„±',
                chartData: [70, 20, 10],
                chartLabels: ['ì™„ë²½ í•´ê²° (ì±…ì„ê°)', 'ë¶€ë¶„ í•´ê²°', 'ë¯¸í•´ê²° (íšŒí”¼)'],
                chartColor: ['rgb(79, 70, 229)', 'rgb(165, 180, 252)', 'rgb(226, 232, 240)']
            }
        };

        const cases = [
            {
                title: "ìƒí™© 1: ë³µì¡í•œ ë³´í—˜ ì„œë¥˜ ìš”ì²­",
                bad: "ì €í¬ëŠ” ì˜ ëª°ë¼ìš”. ë³´í—˜ì‚¬ì— ì§ì ‘ ë¬¼ì–´ë³´ì„¸ìš”.",
                good: "ë³´í—˜ì‚¬ë§ˆë‹¤ ì–‘ì‹ì´ ë‹¤ë¦…ë‹ˆë‹¤. ì•½ê´€ì„ ë³´ì—¬ì£¼ì‹œë©´ ì •í™•íˆ í™•ì¸í•´ ë“œë¦´ê²Œìš”.",
                badge: "ì „ë¬¸ì„±",
                badgeClass: "bg-teal-200 text-teal-800",
                goodBorder: "border-teal-500",
                reason: "í™˜ìì˜ ë¬¸ì œë¥¼ ì •í™•í•œ ì§€ì‹ì„ ë°”íƒ•ìœ¼ë¡œ í•´ê²°í•´ì£¼ë ¤ëŠ” íƒœë„ì…ë‹ˆë‹¤."
            },
            {
                title: "ìƒí™© 2: ëŒ€ê¸° ì‹œê°„ì— í™”ë‚œ í™˜ì",
                bad: "ì•ì— í™˜ìê°€ ë°€ë ¤ì„œ ì–´ì©” ìˆ˜ ì—†ì–´ìš”. ê¸°ë‹¤ë¦¬ì„¸ìš”.",
                good: "ì˜¤ë˜ ê¸°ë‹¤ë¦¬ê²Œ í•´ì„œ ì£„ì†¡í•©ë‹ˆë‹¤. ëª¸ë„ í˜ë“œì‹ ë° ì§€ë£¨í•˜ì…¨ì£ ?",
                badge: "ê³µê°",
                badgeClass: "bg-rose-200 text-rose-800",
                goodBorder: "border-rose-500",
                reason: "í™˜ìì˜ ì§œì¦ë‚œ ê°ì •ì„ ì¸ì •í•˜ê³  ìœ„ë¡œí•˜ì—¬ ë¼í¬(Rapport)ë¥¼ í˜•ì„±í–ˆìŠµë‹ˆë‹¤."
            },
            {
                title: "ìƒí™© 3: ìˆ˜ë‚© ê¸ˆì•¡ ì˜¤ë¥˜ ë°œìƒ",
                bad: "ì „ì‚° ì˜¤ë¥˜ì¸ê°€ ë´ìš”. ì·¨ì†Œí•˜ê³  ë‹¤ì‹œ í• ê²Œìš”.",
                good: "ì œ í™•ì¸ ë¶ˆì°°ì…ë‹ˆë‹¤. ì¦‰ì‹œ ì •ì •í•˜ê³  ì˜ìˆ˜ì¦ í•­ëª©ì„ ë‹¤ì‹œ ì„¤ëª…í•´ ë“œë¦¬ê² ìŠµë‹ˆë‹¤.",
                badge: "ì±…ì„ê°",
                badgeClass: "bg-indigo-200 text-indigo-800",
                goodBorder: "border-indigo-500",
                reason: "ì‹¤ìˆ˜ë¥¼ ì¸ì •í•˜ê³ , ìˆ˜ì •ë¿ë§Œ ì•„ë‹ˆë¼ ì¬ì„¤ëª…ê¹Œì§€ í•˜ì—¬ ëê¹Œì§€ ì±…ì„ì„ ì¡ŒìŠµë‹ˆë‹¤."
            }
        ];

        let currentChart = null;
        let currentScenarioText = ""; // To store AI generated scenario

        document.addEventListener('DOMContentLoaded', () => {
            loadCase();
        });

        // --- Core Application Logic (Pillars, Charts, Basic Cases) ---

        function selectPillar(key) {
            const data = competencies[key];
            const section = document.getElementById('detail-section');
            section.classList.remove('hidden');
            section.scrollIntoView({ behavior: 'smooth', block: 'start' });

            document.getElementById('detail-icon').textContent = data.icon;
            document.getElementById('detail-title').textContent = data.title;
            document.getElementById('detail-slogan').textContent = `"${data.slogan}"`;
            document.getElementById('detail-definition').textContent = data.definition;
            document.getElementById('detail-message').textContent = data.message;
            document.getElementById('detail-border-color').className = `bg-slate-50 p-4 rounded-lg border-l-4 ${data.colorClass}`;

            const listEl = document.getElementById('detail-list');
            listEl.innerHTML = '';
            data.list.forEach(item => {
                const li = document.createElement('li');
                li.className = "flex items-start text-slate-600";
                li.innerHTML = `<span class="mr-2 text-teal-500">âœ“</span><span>${item}</span>`;
                listEl.appendChild(li);
            });
            renderChart(data);
        }

        function renderChart(data) {
            const ctx = document.getElementById('competencyChart').getContext('2d');
            if (currentChart) currentChart.destroy();
            const config = {
                type: data.chartType,
                data: {
                    labels: data.chartLabels,
                    datasets: [{
                        label: data.chartLabel,
                        data: data.chartData,
                        backgroundColor: data.chartColor,
                        borderColor: Array.isArray(data.chartColor) ? data.chartColor[0] : data.chartColor,
                        borderWidth: 1,
                        tension: 0.3,
                        fill: data.chartType === 'line'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: data.chartType === 'doughnut', position: 'bottom' },
                        title: { display: true, text: data.chartLabel, padding: 20 }
                    }
                }
            };
            currentChart = new Chart(ctx, config);
        }

        function loadCase() {
            const index = document.getElementById('case-selector').value;
            const data = cases[index];
            const badContent = document.getElementById('bad-case-content');
            const goodContent = document.getElementById('good-case-content');
            
            badContent.style.opacity = '0';
            goodContent.style.opacity = '0';

            setTimeout(() => {
                badContent.textContent = `"${data.bad}"`;
                goodContent.textContent = `"${data.good}"`;
                document.getElementById('case-badge').textContent = data.badge;
                document.getElementById('case-badge').className = `text-xs px-2 py-1 rounded-full font-bold ${data.badgeClass}`;
                goodContent.className = goodContent.className.replace(/border-\w+-500/g, '');
                goodContent.classList.add(data.goodBorder);
                document.getElementById('case-reason').textContent = data.reason;
                badContent.style.opacity = '1';
                goodContent.style.opacity = '1';
            }, 200);
        }

        function updateProgress() {
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            const checked = document.querySelectorAll('input[type="checkbox"]:checked');
            const percentage = (checked.length / checkboxes.length) * 100;
            const progressBar = document.getElementById('progress-bar');
            const progressText = document.getElementById('progress-text');

            progressBar.style.width = percentage + '%';
            if (percentage === 0) progressText.textContent = "ìœ„ í•­ëª©ë“¤ì„ ì²´í¬í•˜ì—¬ ë‹¹ì‹ ì˜ í”„ë¡œ ì§€ìˆ˜ë¥¼ í™•ì¸í•˜ì„¸ìš”.";
            else if (percentage < 50) progressText.textContent = "ì‹œì‘ì´ ë°˜ì…ë‹ˆë‹¤! í•µì‹¬ ì—­ëŸ‰ì„ í•˜ë‚˜ì”© ê°–ì¶°ê°€ì„¸ìš”.";
            else if (percentage < 100) progressText.textContent = "í›Œë¥­í•©ë‹ˆë‹¤! ê±°ì˜ ì™„ë²½í•œ ì „ë¬¸ê°€ê°€ ë˜ì–´ê°€ê³  ìˆìŠµë‹ˆë‹¤.";
            else progressText.textContent = "ì™„ë²½í•©ë‹ˆë‹¤! ë‹¹ì‹ ì€ ì¤€ë¹„ëœ ë³´ê±´ì˜ë£Œì •ë³´ ì „ë¬¸ê°€ì…ë‹ˆë‹¤. ğŸ‰";
        }

        // --- GEMINI API Logic ---

        async function callGemini(prompt) {
            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: prompt }] }]
                    })
                });

                if (!response.ok) {
                    throw new Error(`API Error: ${response.status}`);
                }

                const data = await response.json();
                return data.candidates[0].content.parts[0].text;
            } catch (error) {
                console.error("Gemini Error:", error);
                return "ì£„ì†¡í•©ë‹ˆë‹¤. AI ì„œë¹„ìŠ¤ ì—°ê²°ì— ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.";
            }
        }

        async function generateScenario() {
            const btn = document.getElementById('btn-generate');
            const spinner = document.getElementById('spinner-gen');
            const box = document.getElementById('ai-scenario-box');

            // UI Loading State
            btn.disabled = true;
            spinner.classList.remove('hidden');
            box.innerHTML = '<span class="text-purple-300 animate-pulse">ìƒí™©ì„ ìƒì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤...</span>';

            const prompt = `
                Role: Hospital Service Training Instructor.
                Task: Generate a realistic, challenging scenario for a hospital administration staff member. It should involve either a difficult patient (complaint, anxiety) or a complex administrative situation (insurance, error).
                Language: Korean.
                Format: Just the scenario description text. 2-3 sentences.
                Tone: Professional but urgent.
            `;

            const result = await callGemini(prompt);
            
            // Save and Display
            currentScenarioText = result;
            box.classList.remove('flex', 'items-center', 'justify-center', 'text-center', 'text-purple-200'); // Reset default styles
            box.classList.add('bg-white', 'text-slate-800', 'text-left'); // Active styles
            box.innerHTML = `<div class="font-medium text-lg">ğŸ“¢ ìƒí™©:</div><div class="mt-2">${result}</div>`;

            // Reset UI
            btn.disabled = false;
            spinner.classList.add('hidden');
            
            // Focus on input
            document.getElementById('user-response').focus();
        }

        async function analyzeResponse() {
            const userResponse = document.getElementById('user-response').value;
            const btn = document.getElementById('btn-analyze');
            const spinner = document.getElementById('spinner-analyze');
            const feedbackBox = document.getElementById('ai-feedback-box');
            const feedbackContent = document.getElementById('ai-feedback-content');

            if (!currentScenarioText) {
                alert("ë¨¼ì € 'ìƒˆë¡œìš´ ìƒí™© ìƒì„±í•˜ê¸°' ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”!");
                return;
            }
            if (!userResponse.trim()) {
                alert("ì‘ëŒ€ ë©˜íŠ¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!");
                return;
            }

            // UI Loading State
            btn.disabled = true;
            spinner.classList.remove('hidden');
            feedbackBox.classList.add('hidden');

            const prompt = `
                Role: Hospital Service Expert & Coach.
                Task: Evaluate the user's response to a specific hospital scenario based on 3 core competencies: Professionalism, Empathy, Responsibility.
                
                Scenario: "${currentScenarioText}"
                User Response: "${userResponse}"
                
                Output Format (in Korean Markdown):
                1. **Overall Score**: X/100
                2. **Analysis by Competency**:
                   - Professionalism: [Evaluation]
                   - Empathy: [Evaluation]
                   - Responsibility: [Evaluation]
                3. **Better Example**: Provide a refined, perfect version of the response.
                
                Keep the tone encouraging but professional.
            `;

            const result = await callGemini(prompt);

            // Render Markdown
            feedbackContent.innerHTML = marked.parse(result);
            
            // Show Result
            feedbackBox.classList.remove('hidden');
            feedbackBox.scrollIntoView({ behavior: 'smooth', block: 'center' });

            // Reset UI
            btn.disabled = false;
            spinner.classList.add('hidden');
        }
    </script>
</body>
</html>